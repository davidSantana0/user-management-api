# API de Gerenciamento de Usu√°rios

Uma API RESTful completa para gerenciamento de usu√°rios, constru√≠da com Node.js, Express, MongoDB e TypeScript. Inclui autentica√ß√£o baseada em JWT, controle de acesso por fun√ß√£o (admin/usu√°rio), hashing de senhas e containeriza√ß√£o com Docker.

Este projeto foi projetado para ser um ponto de partida robusto e seguro para aplica√ß√µes que necessitam de um sistema de autentica√ß√£o e gerenciamento de usu√°rios. O c√≥digo √© escrito com foco em boas pr√°ticas, clareza e manutenibilidade.

## ‚ú® Vis√£o Geral dos Recursos

- **CRUD completo de usu√°rios:** Crie, leia, atualize e delete usu√°rios.
- **Autentica√ß√£o com JWT:** Gera√ß√£o e valida√ß√£o de JSON Web Tokens para proteger rotas.
- **Controle de Acesso Baseado em Fun√ß√£o (RBAC):** Distin√ß√£o entre usu√°rios comuns e administradores, com rotas e opera√ß√µes restritas.
- **Hashing de Senhas:** As senhas s√£o armazenadas de forma segura usando o algoritmo bcrypt.
- **Valida√ß√£o de Dados:** Utiliza√ß√£o de DTOs (Data Transfer Objects) para validar e tipar os dados de entrada.
- **Estrutura de Projeto Escal√°vel:** O c√≥digo √© organizado em m√≥dulos (controllers, services, routes, etc.) para facilitar a manuten√ß√£o e o crescimento do projeto.
- **Containeriza√ß√£o com Docker:** Inclui um `Dockerfile` para criar uma imagem da aplica√ß√£o e execut√°-la em um ambiente isolado e consistente.
- **Qualidade de C√≥digo:** Configurado com ESLint e Prettier para garantir um padr√£o de c√≥digo limpo e consistente.

## üöÄ Come√ßando

Estas instru√ß√µes guiar√£o voc√™ na configura√ß√£o e execu√ß√£o do projeto em seu ambiente de desenvolvimento local.

### üìã Pr√©-requisitos

Antes de come√ßar, certifique-se de ter as seguintes ferramentas instaladas em sua m√°quina:

- [Node.js](https://nodejs.org/en/) (vers√£o 20 ou superior)
- [npm](https://www.npmjs.com/) (geralmente vem com o Node.js)
- [Docker](https://www.docker.com/products/docker-desktop) (opcional, para execu√ß√£o via container)
- [Git](https://git-scm.com/)

Voc√™ tamb√©m precisar√° de uma inst√¢ncia do [MongoDB](https://www.mongodb.com/try/download/community) em execu√ß√£o. Voc√™ pode instal√°-lo localmente ou usar um servi√ßo de nuvem como o [MongoDB Atlas](https://www.mongodb.com/cloud/atlas).

### üîß Instala√ß√£o

Siga estes passos para configurar o projeto:

1. **Clone o reposit√≥rio:**

   ```bash
   git clone https://github.com/davidSantana0/user-management-api.git
   cd user-management-api
   ```

2. **Instale as depend√™ncias:**

   Use o npm para instalar todas as depend√™ncias listadas no arquivo `package.json`.

   ```bash
   npm install
   ```

3. **Configure as vari√°veis de ambiente:**

   Crie um arquivo chamado `.env` na raiz do projeto. Este arquivo armazenar√° suas vari√°veis de ambiente sens√≠veis. Copie o conte√∫do do arquivo `.env.example` (se houver) ou adicione as seguintes vari√°veis:

   ```env
   # Porta em que o servidor ser√° executado
   PORT=3000

   # Credenciais e URL do seu banco de dados MongoDB
   DB_USER=seu_usuario_do_banco
   DB_PASSWORD=sua_senha_do_banco
   MONGODB_URL=mongodb+srv://<user>:<password>@cluster.mongodb.net/sua_base_de_dados

   # Chave secreta para assinar os tokens JWT
   JWT_SECRET=sua_chave_secreta_super_segura
   ```

   **Importante:** Substitua os valores de exemplo pelas suas pr√≥prias credenciais e informa√ß√µes. Nunca exponha suas chaves secretas ou senhas em reposit√≥rios p√∫blicos.

### ‚ñ∂Ô∏è Executando a Aplica√ß√£o

#### Localmente

1. **Compile o c√≥digo TypeScript:**

   Este comando transpila o c√≥digo TypeScript (`.ts`) para JavaScript (`.js`), que o Node.js pode executar. O resultado ser√° salvo na pasta `dist`.

   ```bash
   npm run build
   ```

2. **Inicie o servidor:**

   Este comando inicia o servidor Node.js, que come√ßar√° a ouvir por requisi√ß√µes na porta que voc√™ definiu no arquivo `.env`.

   ```bash
   npm run start
   ```

   Se tudo correr bem, voc√™ ver√° uma mensagem no console indicando que o servidor est√° rodando. A API estar√° dispon√≠vel em `http://localhost:3000`.

#### Com Docker

Se voc√™ preferir usar o Docker para executar a aplica√ß√£o em um container, siga estes passos:

1. **Construa a imagem Docker:**

   Este comando l√™ o `Dockerfile` e constr√≥i uma imagem da sua aplica√ß√£o, empacotando todo o c√≥digo e as depend√™ncias.

   ```bash
   docker build -t auth-users-api-app .
   ```

2. **Execute o container:**

   Este comando cria e inicia um container a partir da imagem que voc√™ acabou de construir. A flag `-p 3000:3000` mapeia a porta 3000 do container para a porta 3000 da sua m√°quina local.

   ```bash
   docker run -p 3000:3000 auth-users-api-app
   ```

   A API estar√° acess√≠vel em `http://localhost:3000`, da mesma forma que na execu√ß√£o local.

## üõ†Ô∏è Tecnologias Utilizadas

Este projeto foi constru√≠do com as seguintes tecnologias e ferramentas:

- **Node.js 20:** Ambiente de execu√ß√£o JavaScript no lado do servidor.
- **TypeScript:** Superset do JavaScript que adiciona tipagem est√°tica.
- **Express.js:** Framework web minimalista e flex√≠vel para Node.js.
- **MongoDB:** Banco de dados NoSQL orientado a documentos.
- **Mongoose:** ODM (Object Data Modeling) para MongoDB e Node.js, facilitando a intera√ß√£o com o banco de dados.
- **bcrypt:** Biblioteca para hashing de senhas.
- **JSON Web Token (JWT):** Padr√£o aberto para cria√ß√£o de tokens de acesso que permitem a autentica√ß√£o de requisi√ß√µes.
- **Docker:** Plataforma para desenvolvimento, envio e execu√ß√£o de aplica√ß√µes em containers.
- **ESLint & Prettier:** Ferramentas para linting e formata√ß√£o de c√≥digo, garantindo a qualidade e a consist√™ncia do c√≥digo.

## üìÅ Estrutura do Projeto

A estrutura de pastas do projeto foi pensada para ser organizada e escal√°vel:

```
src/
‚îú‚îÄ @types/          # Defini√ß√µes de tipos customizados para bibliotecas externas.
‚îú‚îÄ auth/            # L√≥gica de autentica√ß√£o, gera√ß√£o e valida√ß√£o de JWT.
‚îú‚îÄ constants/       # Constantes da aplica√ß√£o, como mensagens de erro e status codes.
‚îú‚îÄ controllers/     # Camada respons√°vel por receber as requisi√ß√µes HTTP e retornar as respostas.
‚îú‚îÄ database/
‚îÇ  ‚îî‚îÄ models/       # Defini√ß√£o dos schemas e models do Mongoose.
‚îú‚îÄ dtos/            # Data Transfer Objects: objetos que definem a estrutura dos dados que entram e saem da API.
‚îú‚îÄ errors/          # Classes de erro customizadas para um tratamento de erros mais robusto.
‚îú‚îÄ middleware/      # Fun√ß√µes que s√£o executadas entre a requisi√ß√£o e a resposta (ex: autentica√ß√£o, valida√ß√£o).
‚îú‚îÄ routes/          # Defini√ß√£o das rotas da API.
‚îú‚îÄ services/        # Camada de servi√ßo, onde reside a l√≥gica de neg√≥cio da aplica√ß√£o.
‚îú‚îÄ types/           # Tipos e interfaces TypeScript compartilhados pela aplica√ß√£o.
‚îú‚îÄ utils/           # Fun√ß√µes utilit√°rias gen√©ricas (ex: hashing de senhas).
‚îú‚îÄ app.ts           # Ponto de entrada da aplica√ß√£o, onde o Express √© configurado.
‚îú‚îÄ route.ts         # Arquivo que agrega e configura todas as rotas da aplica√ß√£o.
‚îú‚îÄ server.ts        # Arquivo respons√°vel por iniciar o servidor HTTP.
‚îú‚îÄ Dockerfile       # Instru√ß√µes para construir a imagem Docker da aplica√ß√£o.
‚îî‚îÄ .env             # Arquivo para armazenar as vari√°veis de ambiente (n√£o versionado).
```

## üó∫Ô∏è Endpoints da API

A seguir, uma descri√ß√£o detalhada dos endpoints dispon√≠veis na API.

### Autentica√ß√£o e Admin

| M√©todo | Rota        | Protegido | Descri√ß√£o                                                                 |
| :----- | :---------- | :-------- | :------------------------------------------------------------------------ |
| `POST` | `/auth/login` | ‚ùå N√£o      | Autentica um usu√°rio com email e senha e retorna um token JWT.              |
| `POST` | `/auth/admin` | ‚úÖ Admin    | Cria um novo usu√°rio com a fun√ß√£o de `ADMIN`. Requer token de um admin.     |
| `GET`  | `/auth/me`    | ‚úÖ Sim      | Retorna as informa√ß√µes do usu√°rio atualmente logado (identificado pelo JWT). |

### Usu√°rios

| M√©todo | Rota      | Protegido | Descri√ß√£o                                                                    |
| :----- | :-------- | :-------- | :--------------------------------------------------------------------------- |
| `POST` | `/user`     | ‚ùå N√£o      | Cria um novo usu√°rio.                                                        |
| `GET`  | `/user`     | ‚ùå N√£o      | Lista todos os usu√°rios cadastrados.                                         |
| `GET`  | `/user/:id` | ‚ùå N√£o      | Busca e retorna um usu√°rio espec√≠fico pelo seu ID.                           |
| `PUT`  | `/user/:id` | ‚úÖ Sim      | Atualiza as informa√ß√µes de um usu√°rio. Requer token do pr√≥prio usu√°rio ou de um admin. |
| `DELETE` | `/user/:id` | ‚úÖ Admin    | Deleta um usu√°rio. Requer token de um admin.                                 |

